<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ASTRA-Net Platform | YAKAMI TECH</title>
  <meta name="description" content="Sistema de monitoramento e rastreamento por sat√©lite para a Amaz√¥nia - Tecnologia de √ìrbita Baixa (LEO)" />
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Leaflet (Mapa) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  
  <style>
    body { font-family: 'IBM Plex Mono', monospace; }
    .leaflet-container { background: #1e293b; }
    .vessel-marker { 
      border-radius: 50%; 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      font-size: 10px;
      color: black;
      transition: all 0.3s ease;
      box-shadow: 0 1px 3px rgba(0,0,0,0.2);
    }
    .vessel-balsa { background-color: #f97316; }
    .vessel-lancha { background-color: #facc15; }
    .vessel-recreio { background-color: #e5e7eb; }
    .vessel-navio-patrulha { background-color: #3b82f6; color: white;}
    .vessel-carga { background-color: #6b7280; color: white;}
    .vessel-hidrooceanografico { background-color: #10b981; }
    .vessel-hospitalar { background-color: #ef4444; color: white;}
    .animate-pulse-sos {
      animation: pulse-sos 1.5s infinite;
    }
    @keyframes pulse-sos {
      0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
      50% { box-shadow: 0 0 0 10px rgba(239, 68, 68, 0); }
    }
    .panel-bg { background: #1e293b; border: 1px solid #334155; }
    .panel-title { border-bottom: 1px solid #334155; padding-bottom: 0.5rem; margin-bottom: 0.5rem; }
  </style>
</head>
<body class="bg-gray-900 text-gray-200">

  <!-- Cabe√ßalho -->
  <header class="bg-white/10 backdrop-blur-sm border-b border-gray-800 py-4">
    <div class="container mx-auto px-4 flex items-center justify-between">
      <a href="https://www.yakami.com.br/" class="flex items-center space-x-2">
        <i class="fas fa-satellite text-orange-500 text-xl"></i>
        <span class="font-bold text-lg">YAKAMI TECH</span>
      </a>
      <div class="text-sm bg-orange-500/20 text-orange-300 px-3 py-1 rounded-full flex items-center space-x-1">
        <!-- CORRE√á√ÉO: Link do logo oficial do Space Apps -->
        <img src="https://www.spaceappschallenge.org/wp-content/uploads/2024/02/sac-logo-lockup-nasa.png" alt="NASA Space Apps" class="h-4">
        <span>Space Apps Challenge 2025</span>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 py-8">
    <!-- T√≠tulo -->
    <div class="text-center mb-10">
      <h1 class="text-3xl md:text-4xl font-bold mb-2">ASTRA-Net Platform</h1>
      <p class="text-gray-400 max-w-2xl mx-auto">
        Sistema de monitoramento e rastreamento por sat√©lite para a Amaz√¥nia - Tecnologia de √ìrbita Baixa (LEO)
      </p>
    </div>

    <!-- Se√ß√£o de Demonstra√ß√£o -->
    <div class="text-center mb-8">
      <h2 class="text-xl font-bold mb-2">DEMONSTRA√á√ÉO INTERATIVA</h2>
      <h3 class="text-lg text-gray-400 mb-2">Mapa de Monitoramento & Opera√ß√µes Fluviais da Amaz√¥nia</h3>
    </div>

    <!-- Layout Principal -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <!-- Mapa -->
      <div class="lg:col-span-2">
        <div id="map" class="w-full h-[500px] lg:h-full rounded-xl border border-gray-700 shadow-lg"></div>
      </div>

      <!-- Pain√©is Laterais -->
      <!-- CORRE√á√ÉO: Removido 'h-[500px]' e 'lg:h-auto' para permitir altura natural -->
      <div class="lg:col-span-1 flex flex-col space-y-4">
        <div id="telemetry-panel" class="panel-bg p-4 rounded-lg flex-grow"></div>
        <div id="orbital-panel" class="panel-bg p-4 rounded-lg flex-grow"></div>
        <div id="alerts-panel" class="panel-bg p-4 rounded-lg flex-grow"></div>
        <div class="grid grid-cols-2 gap-4">
          <button onclick="activateSOS()" class="bg-red-600 hover:bg-red-500 text-white px-4 py-2 rounded-lg flex items-center justify-center">
            <i class="fas fa-exclamation-triangle mr-2"></i> S.O.S
          </button>
          <button class="bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-lg flex items-center justify-center">
            <i class="fas fa-envelope mr-2"></i> Mensagem
          </button>
        </div>
      </div>
    </div>
    
    <!-- Se√ß√£o: Integra√ß√£o NASA -->
    <section class="mt-12">
        <div class="text-center mb-8">
            <h2 class="text-2xl font-bold">Integra√ß√£o com Dados da NASA</h2>
            <p class="text-gray-400 mt-2 max-w-3xl mx-auto">Utilizando o ecossistema de dados da NASA para uma opera√ß√£o mais inteligente e segura na Amaz√¥nia.</p>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
            <div class="bg-gray-800 p-5 rounded-lg border border-gray-700">
                <i class="fas fa-globe-americas text-blue-400 text-2xl mb-3"></i>
                <h3 class="font-bold mb-2">NASA Earthdata Search</h3>
                <p class="text-sm text-gray-400">Monitoramento ambiental, an√°lise de desmatamento e qualidade da √°gua dos rios.</p>
            </div>
            <div class="bg-gray-800 p-5 rounded-lg border border-gray-700">
                <i class="fas fa-solar-panel text-yellow-400 text-2xl mb-3"></i>
                <h3 class="font-bold mb-2">NASA POWER</h3>
                <p class="text-sm text-gray-400">Previs√£o de irradia√ß√£o solar para otimizar a gera√ß√£o de energia das YAKAMI Eco Stations.</p>
            </div>
            <div class="bg-gray-800 p-5 rounded-lg border border-gray-700">
                <i class="fas fa-user-astronaut text-gray-300 text-2xl mb-3"></i>
                <h3 class="font-bold mb-2">Orbital Debris Program</h3>
                <p class="text-sm text-gray-400">Planejamento de √≥rbita e mitiga√ß√£o de riscos para a futura constela√ß√£o YAKAMI-SAT.</p>
            </div>
            <div class="bg-gray-800 p-5 rounded-lg border border-gray-700">
                <i class="fas fa-broadcast-tower text-green-400 text-2xl mb-3"></i>
                <h3 class="font-bold mb-2">Satellite Situation Report</h3>
                <p class="text-sm text-gray-400">Otimiza√ß√£o das janelas de comunica√ß√£o com sat√©lites ativos para garantir a conectividade.</p>
            </div>
        </div>
    </section>

    <!-- Se√ß√£o: Conformidade NORMAM-204 -->
    <section class="mt-12 bg-blue-900/20 p-6 rounded-xl">
        <h2 class="text-2xl font-bold mb-4">Conformidade com a NORMAM-204 da Marinha do Brasil</h2>
        <p class="text-gray-300 mb-4">
            A partir de 1¬∫ de janeiro de 2026, todas as embarca√ß√µes com Arquea√ß√£o Bruta ‚â• 50 est√£o obrigadas a utilizar um sistema de monitoramento AVL (Automatic Vehicle Location) em tempo real.
        </p>
        <ul class="list-disc pl-5 text-gray-300 space-y-1">
            <li>O ASTRA-Net √© um <strong>Provedor de Servi√ßo de Monitoramento</strong> compat√≠vel com os requisitos da Marinha.</li>
            <li>Nossos dispositivos YAKAMI s√£o certificados pela <strong>Anatel</strong> e transmitem dados para o <strong>SISTRAM</strong>.</li>
            <li>Garantimos <strong>180 dias de armazenamento de dados</strong> para auditoria.</li>
        </ul>
    </section>
  </main>

  <script>
    // --- INICIALIZA√á√ÉO DO MAPA ---
    const map = L.map('map').setView([-3.4, -60.5], 7);
    
    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
      maxZoom: 18
    }).addTo(map);

    // --- RIOS DA AMAZ√îNIA ---
    fetch('https://overpass-api.de/api/interpreter?data=[out:json];way["waterway"="river"](bbox:-4.5,-62,-2.5,-58);out geom;')
      .then(r => r.json())
      .then(data => {
        data.elements.forEach(way => {
          if(way.geometry) {
            const coords = way.geometry.map(p => [p.lat, p.lon]);
            L.polyline(coords, { color: '#3b82f6', weight: 3, opacity: 0.7 }).addTo(map);
          }
        });
      });

    // --- PONTOS DE INTERESSE EXPANDIDOS ---
    const pointsOfInterest = [
        { nome: "Porto de Manaus", lat: -3.134, lng: -59.992, type: 'porto-organizado' },
        { nome: "Porto Chibat√£o", lat: -3.145, lng: -60.025, type: 'porto-container' },
        { nome: "Super Terminais (Itacoatiara)", lat: -3.143, lng: -58.444, type: 'porto-container' },
        { nome: "Porto de Manacapuru", lat: -3.30, lng: -60.62, type: 'porto-organizado' },
        { nome: "Porto de Novo Air√£o", lat: -2.62, lng: -60.94, type: 'porto-organizado' },
        { nome: "Comunidade Janauari", lat: -3.22, lng: -60.15, type: 'comunidade' },
        { nome: "Comunidade do Tup√©", lat: -3.05, lng: -60.25, type: 'comunidade' },
        { nome: "Base da Marinha (9¬∫ DN)", lat: -3.1100, lng: -60.0100, type: 'marinha' },
        { nome: "Escola Flutuante", lat: -3.15, lng: -60.05, type: 'escola' },
        { nome: "Base de Pesquisa INPA", lat: -2.65, lng: -60.21, type: 'pesquisa' }
    ];

    pointsOfInterest.forEach(p => {
        let iconHtml, iconClass;
        switch(p.type) {
            case 'porto-organizado': iconHtml = '<i class="fas fa-ship"></i>'; iconClass = 'text-amber-500'; break;
            case 'porto-container': iconHtml = '<i class="fas fa-warehouse"></i>'; iconClass = 'text-gray-400'; break;
            case 'comunidade': iconHtml = '<i class="fas fa-users"></i>'; iconClass = 'text-sky-500'; break;
            case 'marinha': iconHtml = '<i class="fas fa-shield-alt"></i>'; iconClass = 'text-blue-600'; break;
            case 'escola': iconHtml = '<i class="fas fa-school"></i>'; iconClass = 'text-green-500'; break;
            case 'pesquisa': iconHtml = '<i class="fas fa-flask"></i>'; iconClass = 'text-purple-500'; break;
            default: iconHtml = '<i class="fas fa-map-marker-alt"></i>'; iconClass = 'text-white';
        }
        const icon = L.divIcon({ className: `point-marker ${iconClass} text-2xl`, html: iconHtml, iconSize: [24, 24] });
        L.marker([p.lat, p.lng], { icon: icon }).addTo(map).bindPopup(`<strong>${p.nome}</strong>`);
    });
    
    // --- DADOS DO ECOSSISTEMA ---
    const riverLevels = {};
    pointsOfInterest.filter(p => p.type.includes('porto')).forEach(p => {
        riverLevels[p.nome] = { level: 15 + Math.random() * 10, status: 'Normal' };
    });

    // --- FROTA AUT√äNTICA ---
    const vessels = [
      { id: 1, nome: "Balsa Iranduba", empresa: "Barcas Iranduba", tipo: "balsa", rota: "Manaus ‚Üî Iranduba", lat: -3.1350, lng: -60.2100, bateria: 88, sinal: -80, velocidade: 8, rpm: 1500 },
      { id: 2, nome: "Lancha Janauari", empresa: "COOBARQ", tipo: "lancha", rota: "Manaus ‚Üî Janauari", lat: -3.0600, lng: -60.0900, bateria: 92, sinal: -75, velocidade: 18, rpm: 2800 },
      { id: 3, nome: "Recreio Parintins", empresa: "Navegam", tipo: "recreio", rota: "Manaus ‚Üî Parintins", lat: -2.9500, lng: -60.3000, bateria: 85, sinal: -90, velocidade: 15, rpm: 2000 },
      { id: 4, nome: "NPa Pedro Teixeira", empresa: "Marinha do Brasil", tipo: "navio-patrulha", rota: "Patrulha Rio Negro", lat: -3.1100, lng: -60.0100, bateria: 95, sinal: -70, velocidade: 22, rpm: 3000 },
      { id: 7, nome: "Chibat√£o Log", empresa: "Grupo Chibat√£o", tipo: "carga", rota: "Porto Chibat√£o ‚Üî Manaus", lat: -3.0950, lng: -60.0150, bateria: 82, sinal: -88, velocidade: 10, rpm: 1600 },
      { id: 8, nome: "NHo Rio Negro", empresa: "Marinha do Brasil", tipo: "hidrooceanografico", rota: "Levantamento Hidrogr√°fico", lat: -3.2000, lng: -60.1000, bateria: 90, sinal: -85, velocidade: 12, rpm: 1800 },
      { id: 9, nome: "NAsH Oswaldo Cruz", empresa: "Marinha do Brasil", tipo: "hospitalar", rota: "Atendimento Comunidades", lat: -3.1500, lng: -60.0500, bateria: 89, sinal: -82, velocidade: 14, rpm: 1900 }
    ];
    
    const vesselMarkers = {};
    let selectedVessel = null;
    let alerts = [];
    let passSchedule = [];

    // --- FUN√á√ïES DE RENDERIZA√á√ÉO ---
    function getVesselIcon(type) {
        const icons = { balsa: 'truck-moving', lancha: 'bolt', recreio: 'ship', 'navio-patrulha': 'shield-alt', carga: 'box-open', hidrooceanografico: 'water', hospitalar: 'hospital-alt' };
        return icons[type] || 'ship';
    }

    function renderVessels() {
      vessels.forEach(v => {
        const el = L.divIcon({
          className: `vessel-marker vessel-${v.tipo} border-2 ${selectedVessel?.id === v.id ? 'border-yellow-300 scale-125' : 'border-gray-900'} ${v.sosActive ? 'animate-pulse-sos' : ''}`,
          html: `<i class="fas fa-${getVesselIcon(v.tipo)}"></i>`,
          iconSize: [24, 24]
        });
        if (vesselMarkers[v.id]) {
            vesselMarkers[v.id].setLatLng([v.lat, v.lng]).setIcon(el);
        } else {
            vesselMarkers[v.id] = L.marker([v.lat, v.lng], { icon: el }).addTo(map).bindPopup(v.nome).on('click', () => selectVessel(v));
        }
      });
    }

    // --- FUN√á√ïES DE L√ìGICA E INTERA√á√ÉO ---
    function selectVessel(v) {
      selectedVessel = v;
      updateTelemetryPanel();
      updateAlertsPanel();
      renderVessels();
    }

    function activateSOS() {
      if (!selectedVessel) return;
      selectedVessel.sosActive = true;
      addAlert('SOS', `Sinal de SOS recebido de ${selectedVessel.nome}!`);
      renderVessels();
    }
    
    // --- FUN√á√ïES DE SIMULA√á√ÉO ---
    function simulateMovement() {
        vessels.forEach(v => {
            v.lat += (Math.random() - 0.5) * 0.01;
            v.lng += (Math.random() - 0.5) * 0.01;
            v.velocidade += (Math.random() - 0.5) * 0.2;
            v.rpm += (Math.random() - 0.5) * 20;
            v.bateria -= 0.01;
            if (v.bateria < 10) v.bateria = 100;
        });
        renderVessels();
        if (selectedVessel) { updateTelemetryPanel(); }
    }
    
    function simulateRiverLevels() {
        for (const portName in riverLevels) {
            const data = riverLevels[portName];
            data.level += (Math.random() - 0.5) * 0.1;
            if (data.level < 10) data.level = 10;
            if (data.level > 29) data.level = 29;
            if (data.level > 25) data.status = 'Cheia'; else if (data.level > 20) data.status = 'Alerta'; else data.status = 'Normal';
        }
        if (selectedVessel) { updateAlertsPanel(); }
    }

    // --- FUN√á√ïES DE ATUALIZA√á√ÉO DOS PAIN√âIS ---
    function updateTelemetryPanel() {
        const panel = document.getElementById('telemetry-panel');
        if (!selectedVessel) {
            panel.innerHTML = `<h3 class="font-bold panel-title">Telemetria do Ativo</h3><p class="text-gray-500 text-sm">Selecione uma embarca√ß√£o.</p>`;
            return;
        }
        const v = selectedVessel;
        panel.innerHTML = `
            <h3 class="font-bold panel-title">${v.nome}</h3>
            <div class="space-y-1 text-sm">
                <p><i class="fas fa-building fa-fw mr-2 text-gray-400"></i>${v.empresa}</p>
                <p><i class="fas fa-route fa-fw mr-2 text-yellow-500"></i>${v.rota}</p>
                <div class="mt-2 pt-2 border-t border-gray-700 space-y-1">
                    <p><i class="fas fa-map-marker-alt fa-fw mr-2 text-red-400"></i>${v.lat.toFixed(4)}, ${v.lng.toFixed(4)}</p>
                    <p><i class="fas fa-tachometer-alt fa-fw mr-2 text-yellow-500"></i>${v.velocidade.toFixed(1)} n√≥s</p>
                    <p><i class="fas fa-cogs fa-fw mr-2 text-gray-400"></i>${v.rpm.toFixed(0)} RPM</p>
                    <p><i class="fas fa-battery-full fa-fw mr-2 text-green-500"></i>${v.bateria.toFixed(0)}% Bateria</p>
                </div>
            </div>`;
    }

    function addAlert(type, msg) {
        alerts.unshift({ type, msg, time: new Date().toLocaleTimeString() });
        if (alerts.length > 5) alerts.pop();
        updateAlertsPanel();
    }

    function updateAlertsPanel() {
        const panel = document.getElementById('alerts-panel');
        const sosAlerts = alerts.filter(a => a.type === 'SOS').map(a => `<div class="text-sm text-red-400 font-bold animate-pulse"><i class="fas fa-exclamation-triangle mr-2"></i>[${a.time}] ${a.msg}</div>`).join('');
        
        let coPilotContent = `<p class="text-gray-500 text-sm">Selecione uma embarca√ß√£o com rota para ver dados de co-piloto.</p>`;
        
        if (selectedVessel && selectedVessel.rota.includes('‚Üî')) {
            const [origem, destino] = selectedVessel.rota.split(' ‚Üî ');
            const origemPOI = pointsOfInterest.find(p => p.nome.toLowerCase().includes(origem.toLowerCase().trim()));
            const destinoPOI = pointsOfInterest.find(p => p.nome.toLowerCase().includes(destino.toLowerCase().trim()));
            
            let infoOrigem = '', infoDestino = '';
            if (origemPOI && riverLevels[origemPOI.nome]) {
                const data = riverLevels[origemPOI.nome];
                let statusColor = data.status === 'Cheia' ? 'text-red-400' : data.status === 'Alerta' ? 'text-yellow-400' : 'text-green-400';
                infoOrigem = `<p class="text-xs">ORIGEM (${origemPOI.nome.split('(')[0]}): <span class="${statusColor} font-bold">${data.level.toFixed(2)}m</span></p>`;
            } else if (origemPOI) {
                 infoOrigem = `<p class="text-xs">ORIGEM (${origemPOI.nome.split('(')[0]}): <span class="text-gray-500">N/A</span></p>`;
            }
            if (destinoPOI && riverLevels[destinoPOI.nome]) {
                const data = riverLevels[destinoPOI.nome];
                let statusColor = data.status === 'Cheia' ? 'text-red-400' : data.status === 'Alerta' ? 'text-yellow-400' : 'text-green-400';
                infoDestino = `<p class="text-xs">DESTINO (${destinoPOI.nome.split('(')[0]}): <span class="${statusColor} font-bold">${data.level.toFixed(2)}m</span></p>`;
            } else if (destinoPOI) {
                 infoDestino = `<p class="text-xs">DESTINO (${destinoPOI.nome.split('(')[0]}): <span class="text-gray-500">N/A</span></p>`;
            }
            coPilotContent = `<div class="space-y-1">${infoOrigem}${infoDestino}</div>`;
        }
        
        const systemStartAlert = alerts.find(a => a.type === 'SISTEMA');
        panel.innerHTML = `<h3 class="font-bold panel-title">Co-Piloto e Alertas</h3>
            ${sosAlerts || (systemStartAlert ? `<div class="text-sm text-gray-400">[${systemStartAlert.time}] ${systemStartAlert.msg}</div>` : '')}
            <div class="mt-2 pt-2 border-t border-gray-700">
                ${coPilotContent}
            </div>
        `;
    }

    function updateOrbitalPanel() {
        const panel = document.getElementById('orbital-panel');
        const now = new Date();
        if (!passSchedule.length || passSchedule[0].time < now) {
            const sats = ["YAKAMI-SAT-01", "Starlink", "TERRA (NASA)", "AQUA (NASA)", "Sentinel-2"];
            passSchedule = [];
            for (let i = 0; i < 3; i++) {
                passSchedule.push({ sat: sats[Math.floor(Math.random() * sats.length)], time: new Date(now.getTime() + (i * 10 + Math.random() * 15) * 60000), dur: 5 + Math.floor(Math.random() * 5) });
            }
            passSchedule.sort((a,b) => a.time - b.time);
        }
        
        const next = passSchedule[0];
        const timeToPass = next.time - now;
        let statusText = "N√ÉO VIS√çVEL", statusColor = "text-red-500", countdownText = "";
        
        if (timeToPass < 0 && timeToPass > -next.dur * 60000) {
            statusText = "VIS√çVEL"; statusColor = "text-green-400";
            const remaining = Math.floor((next.dur * 60000 + timeToPass) / 1000);
            countdownText = `Fim em: <span class="font-bold">${String(Math.floor(remaining/60)).padStart(2,'0')}:${String(remaining%60).padStart(2,'0')}</span>`;
        } else {
            const diff = Math.max(0, Math.floor(timeToPass / 1000));
            countdownText = `Pr√≥xima em: <span class="font-bold">${String(Math.floor(diff/60)).padStart(2,'0')}:${String(diff%60).padStart(2,'0')}</span>`;
        }
        
        const passList = passSchedule.map(p => `<div class="text-xs ${p === next ? 'text-cyan-300' : ''}">üõ∞Ô∏è ${p.sat} @ ${p.time.toLocaleTimeString()}</div>`).join('');
        panel.innerHTML = `<h3 class="font-bold panel-title">Visibilidade Orbital</h3><div class="text-sm space-y-1"><p>Status: <span class="${statusColor} font-bold">${statusText}</span></p><p>${countdownText}</p></div><div class="mt-2 pt-2 border-t border-gray-700"><h4 class="font-semibold text-sm mb-1">Passagens:</h4>${passList}</div>`;
    }
  
    // --- INICIALIZA√á√ÉO ---
    renderVessels();
    updateTelemetryPanel(null);
    updateAlertsPanel();
    updateOrbitalPanel();
    addAlert('SISTEMA', 'Terminal de opera√ß√µes iniciado.');
    
    setInterval(updateOrbitalPanel, 1000);
    setInterval(simulateMovement, 2500);
    setInterval(simulateRiverLevels, 7000);

  </script>
</body>
</html>